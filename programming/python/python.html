<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Python | Notes</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Notes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/notes/assets/css/0.styles.60ecb326.css" as="style"><link rel="preload" href="/notes/assets/js/app.943eb73b.js" as="script"><link rel="preload" href="/notes/assets/js/3.8465ba19.js" as="script"><link rel="preload" href="/notes/assets/js/82.ebcf132b.js" as="script"><link rel="prefetch" href="/notes/assets/js/10.74f6aed7.js"><link rel="prefetch" href="/notes/assets/js/100.034a3b93.js"><link rel="prefetch" href="/notes/assets/js/101.7a58913c.js"><link rel="prefetch" href="/notes/assets/js/102.09374552.js"><link rel="prefetch" href="/notes/assets/js/103.11ba2dc4.js"><link rel="prefetch" href="/notes/assets/js/104.60a5964b.js"><link rel="prefetch" href="/notes/assets/js/105.86967dd8.js"><link rel="prefetch" href="/notes/assets/js/106.6862691f.js"><link rel="prefetch" href="/notes/assets/js/11.a46c7ced.js"><link rel="prefetch" href="/notes/assets/js/12.c3e4fc46.js"><link rel="prefetch" href="/notes/assets/js/13.674a5639.js"><link rel="prefetch" href="/notes/assets/js/14.fbcf5a64.js"><link rel="prefetch" href="/notes/assets/js/15.5cffcf67.js"><link rel="prefetch" href="/notes/assets/js/16.338f7843.js"><link rel="prefetch" href="/notes/assets/js/17.99d0dc21.js"><link rel="prefetch" href="/notes/assets/js/18.7a01ab35.js"><link rel="prefetch" href="/notes/assets/js/19.2feeedce.js"><link rel="prefetch" href="/notes/assets/js/2.71c806c6.js"><link rel="prefetch" href="/notes/assets/js/20.d918ee7b.js"><link rel="prefetch" href="/notes/assets/js/21.e5104b76.js"><link rel="prefetch" href="/notes/assets/js/22.2d4b2f2a.js"><link rel="prefetch" href="/notes/assets/js/23.185dc70a.js"><link rel="prefetch" href="/notes/assets/js/24.2d25e73e.js"><link rel="prefetch" href="/notes/assets/js/25.e7452036.js"><link rel="prefetch" href="/notes/assets/js/26.bea8aa87.js"><link rel="prefetch" href="/notes/assets/js/27.4f3903f2.js"><link rel="prefetch" href="/notes/assets/js/28.902dbaee.js"><link rel="prefetch" href="/notes/assets/js/29.3deb033b.js"><link rel="prefetch" href="/notes/assets/js/30.d8646ab5.js"><link rel="prefetch" href="/notes/assets/js/31.fec58167.js"><link rel="prefetch" href="/notes/assets/js/32.7dc85083.js"><link rel="prefetch" href="/notes/assets/js/33.c8ed5fae.js"><link rel="prefetch" href="/notes/assets/js/34.6e5ee31a.js"><link rel="prefetch" href="/notes/assets/js/35.ccec245a.js"><link rel="prefetch" href="/notes/assets/js/36.4789f477.js"><link rel="prefetch" href="/notes/assets/js/37.fcd1b611.js"><link rel="prefetch" href="/notes/assets/js/38.e50f556c.js"><link rel="prefetch" href="/notes/assets/js/39.c9da1f8c.js"><link rel="prefetch" href="/notes/assets/js/4.c2282a97.js"><link rel="prefetch" href="/notes/assets/js/40.ecd0969b.js"><link rel="prefetch" href="/notes/assets/js/41.d895d699.js"><link rel="prefetch" href="/notes/assets/js/42.a8f85480.js"><link rel="prefetch" href="/notes/assets/js/43.b0195426.js"><link rel="prefetch" href="/notes/assets/js/44.9bafeff7.js"><link rel="prefetch" href="/notes/assets/js/45.fc069068.js"><link rel="prefetch" href="/notes/assets/js/46.15dac1e7.js"><link rel="prefetch" href="/notes/assets/js/47.3b8c13e7.js"><link rel="prefetch" href="/notes/assets/js/48.9149ea6f.js"><link rel="prefetch" href="/notes/assets/js/49.22096f41.js"><link rel="prefetch" href="/notes/assets/js/5.0a40a8cc.js"><link rel="prefetch" href="/notes/assets/js/50.2ce15617.js"><link rel="prefetch" href="/notes/assets/js/51.ff2268fc.js"><link rel="prefetch" href="/notes/assets/js/52.c0beff8b.js"><link rel="prefetch" href="/notes/assets/js/53.5d9024f6.js"><link rel="prefetch" href="/notes/assets/js/54.a603a0a1.js"><link rel="prefetch" href="/notes/assets/js/55.73ed4382.js"><link rel="prefetch" href="/notes/assets/js/56.3d2bcd4a.js"><link rel="prefetch" href="/notes/assets/js/57.167a12d5.js"><link rel="prefetch" href="/notes/assets/js/58.93bcace4.js"><link rel="prefetch" href="/notes/assets/js/59.0820fe49.js"><link rel="prefetch" href="/notes/assets/js/6.773bcde9.js"><link rel="prefetch" href="/notes/assets/js/60.a5f5280b.js"><link rel="prefetch" href="/notes/assets/js/61.3b526050.js"><link rel="prefetch" href="/notes/assets/js/62.005a7608.js"><link rel="prefetch" href="/notes/assets/js/63.86548806.js"><link rel="prefetch" href="/notes/assets/js/64.7b4e206a.js"><link rel="prefetch" href="/notes/assets/js/65.9e44cd94.js"><link rel="prefetch" href="/notes/assets/js/66.21e77cb2.js"><link rel="prefetch" href="/notes/assets/js/67.e88c090f.js"><link rel="prefetch" href="/notes/assets/js/68.8b474706.js"><link rel="prefetch" href="/notes/assets/js/69.eebbdf3f.js"><link rel="prefetch" href="/notes/assets/js/7.76782ec6.js"><link rel="prefetch" href="/notes/assets/js/70.de49f577.js"><link rel="prefetch" href="/notes/assets/js/71.db75ed0c.js"><link rel="prefetch" href="/notes/assets/js/72.b1aeee29.js"><link rel="prefetch" href="/notes/assets/js/73.8e2a2dc8.js"><link rel="prefetch" href="/notes/assets/js/74.a7643b30.js"><link rel="prefetch" href="/notes/assets/js/75.411c51c2.js"><link rel="prefetch" href="/notes/assets/js/76.9cb71875.js"><link rel="prefetch" href="/notes/assets/js/77.0abca309.js"><link rel="prefetch" href="/notes/assets/js/78.09f80d14.js"><link rel="prefetch" href="/notes/assets/js/79.b618d8d6.js"><link rel="prefetch" href="/notes/assets/js/8.eff1670d.js"><link rel="prefetch" href="/notes/assets/js/80.3f304dd0.js"><link rel="prefetch" href="/notes/assets/js/81.5e1d22e3.js"><link rel="prefetch" href="/notes/assets/js/83.6c998c48.js"><link rel="prefetch" href="/notes/assets/js/84.1bb8ff9f.js"><link rel="prefetch" href="/notes/assets/js/85.915463e8.js"><link rel="prefetch" href="/notes/assets/js/86.54830d70.js"><link rel="prefetch" href="/notes/assets/js/87.4e330a2c.js"><link rel="prefetch" href="/notes/assets/js/88.859b8d56.js"><link rel="prefetch" href="/notes/assets/js/89.31aa01fb.js"><link rel="prefetch" href="/notes/assets/js/9.7bbf0480.js"><link rel="prefetch" href="/notes/assets/js/90.9382184f.js"><link rel="prefetch" href="/notes/assets/js/91.8bb2e809.js"><link rel="prefetch" href="/notes/assets/js/92.44badc72.js"><link rel="prefetch" href="/notes/assets/js/93.091e597a.js"><link rel="prefetch" href="/notes/assets/js/94.eb6ff046.js"><link rel="prefetch" href="/notes/assets/js/95.bccd7cb6.js"><link rel="prefetch" href="/notes/assets/js/96.b8e239ca.js"><link rel="prefetch" href="/notes/assets/js/97.f5f281d8.js"><link rel="prefetch" href="/notes/assets/js/98.90797ed2.js"><link rel="prefetch" href="/notes/assets/js/99.98568f98.js">
    <link rel="stylesheet" href="/notes/assets/css/0.styles.60ecb326.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notes/" class="home-link router-link-active"><!----> <span class="site-name">Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ML and Math" class="dropdown-title"><span class="title">ML and Math</span> <span class="arrow down"></span></button> <button type="button" aria-label="ML and Math" class="mobile-dropdown-title"><span class="title">ML and Math</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/ml/" class="nav-link">
  Machine Learning
</a></li><li class="dropdown-item"><!----> <a href="/notes/math/" class="nav-link">
  Math
</a></li></ul></div></div><div class="nav-item"><a href="/notes/software/" class="nav-link">
  Software and Tools
</a></div><div class="nav-item"><a href="/notes/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/notes/langs/" class="nav-link">
  Languages
</a></div><div class="nav-item"><a href="/notes/reading/" class="nav-link">
  Reading
</a></div><div class="nav-item"><a href="/notes/others/" class="nav-link">
  Others
</a></div> <a href="https://github.com/yzhang-gh/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ML and Math" class="dropdown-title"><span class="title">ML and Math</span> <span class="arrow down"></span></button> <button type="button" aria-label="ML and Math" class="mobile-dropdown-title"><span class="title">ML and Math</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/ml/" class="nav-link">
  Machine Learning
</a></li><li class="dropdown-item"><!----> <a href="/notes/math/" class="nav-link">
  Math
</a></li></ul></div></div><div class="nav-item"><a href="/notes/software/" class="nav-link">
  Software and Tools
</a></div><div class="nav-item"><a href="/notes/programming/" class="nav-link router-link-active">
  Programming
</a></div><div class="nav-item"><a href="/notes/langs/" class="nav-link">
  Languages
</a></div><div class="nav-item"><a href="/notes/reading/" class="nav-link">
  Reading
</a></div><div class="nav-item"><a href="/notes/others/" class="nav-link">
  Others
</a></div> <a href="https://github.com/yzhang-gh/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Python</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/programming/python/miniconda.html" class="sidebar-link">Miniconda</a></li><li><a href="/notes/programming/python/matplotlib.html" class="sidebar-link">Matplotlib</a></li><li><a href="/notes/programming/python/python.html" aria-current="page" class="active sidebar-link">Python</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/programming/python/python.html#作用域-scope" class="sidebar-link">作用域 (scope)</a></li><li class="sidebar-sub-header"><a href="/notes/programming/python/python.html#python-中的路径" class="sidebar-link">Python 中的路径</a></li><li class="sidebar-sub-header"><a href="/notes/programming/python/python.html#手动断行" class="sidebar-link">手动断行</a></li><li class="sidebar-sub-header"><a href="/notes/programming/python/python.html#格式化字符串-string-format" class="sidebar-link">格式化字符串 (string format)</a></li><li class="sidebar-sub-header"><a href="/notes/programming/python/python.html#正则表达式" class="sidebar-link">正则表达式</a></li></ul></li><li><a href="/notes/programming/python/logging.html" class="sidebar-link">Logging</a></li><li><a href="/notes/programming/python/multi-and-sub-process.html" class="sidebar-link">Python 多进程与子进程</a></li><li><a href="/notes/programming/python/user-snippets.html" class="sidebar-link">Python 代码片段</a></li><li><a href="/notes/programming/python/cuda.html" class="sidebar-link">CUDA</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>LaTeX</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/programming/latex.html" class="sidebar-link">LaTeX</a></li><li><a href="/notes/programming/latex-nicematrix.html" class="sidebar-link">nicematrix</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="python"><a href="#python" class="header-anchor">#</a> Python</h1> <h2 id="作用域-scope"><a href="#作用域-scope" class="header-anchor">#</a> 作用域 (scope)</h2> <ul><li>Python 程序由<mark>代码块</mark>组成，包括<strong>模块</strong> (module)，<strong>类</strong> (class)，<strong>函数</strong> (def) 等<br>
注意 <strong>if</strong>，<strong>for</strong> 等语句不构成代码块</li> <li>当变量在<strong>代码块</strong>中被定义时，作用域为该代码块</li></ul> <h3 id="变量名解析-legb-法则"><a href="#变量名解析-legb-法则" class="header-anchor">#</a> 变量名解析 LEGB 法则</h3> <p>变量名解析顺序：最近的 scope</p> <div class="language-python extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#005CC5;">__name__</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">__file__</span><span style="color:#24292E;">        </span><span style="color:#6A737D;">## Builtin</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">global_var </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">            </span><span style="color:#6A737D;">## Global (i.e. module-scoped)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">outer</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    enclosing_var </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">     </span><span style="color:#6A737D;">## Enclosing (relative to `inner`)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">inner</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">        local_var </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">     </span><span style="color:#6A737D;">## Local</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;Local     </span><span style="color:#005CC5;">{</span><span style="color:#24292E;">local_var</span><span style="color:#D73A49;">:^8</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;Enclosing </span><span style="color:#005CC5;">{</span><span style="color:#24292E;">enclosing_var</span><span style="color:#D73A49;">:^8</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;Global    </span><span style="color:#005CC5;">{</span><span style="color:#24292E;">global_var</span><span style="color:#D73A49;">:^8</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;Builtin   </span><span style="color:#005CC5;">{__name__</span><span style="color:#D73A49;">:^8</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    inner()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">__name__</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;__main__&quot;</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    outer()</span></span>
<span class="line"></span></code></pre></div><p>Output</p> <div class="language- extra-class"><pre><code>Local        3
Enclosing    2
Global       1
Builtin   __main__
</code></pre></div><h3 id="unboundlocalerror"><a href="#unboundlocalerror" class="header-anchor">#</a> UnboundLocalError</h3> <div class="language-python extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#24292E;">global_var </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">f1</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(global_var)     </span><span style="color:#6A737D;">## 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">f2</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    global_var </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">        </span><span style="color:#6A737D;">## We now have a local variable 'global_var' within f2</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(global_var)     </span><span style="color:#6A737D;">## 2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">f3</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(global_var)     </span><span style="color:#6A737D;">## UnboundLocalError: local variable 'global_var'↵</span></span>
<span class="line"><span style="color:#24292E;">    global_var </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">        </span><span style="color:#6A737D;">## referenced before assignment</span></span>
<span class="line"></span></code></pre></div><p>因为 Python 中局部变量可以和全局变量同名，所以上述错误时常出现。<br>
如果代码块中任何位置出现了<strong>变量名绑定语句</strong>（比如 <code>a = 2</code>），则该代码块中所有变量名 a 都指向该局部变量，<strong>包括出现在变量名绑定之前的语句</strong>。</p> <p>好消息是这种错误可以被静态检查工具发现（比如 Pyright）</p> <p>注意 <code>global_dict['foo'] = 'bar'</code> 不是变量名绑定语句，不会导致这种错误（<code>global_dict = {'foo': 'bar'}</code> 才是）</p> <p><a href="https://docs.python.org/3/reference/executionmodel.html" target="_blank" rel="noopener noreferrer">Python 执行模型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="python-中的路径"><a href="#python-中的路径" class="header-anchor">#</a> Python 中的路径</h2> <h3 id="工作目录"><a href="#工作目录" class="header-anchor">#</a> 工作目录</h3> <p>每一个进程都有对应的工作目录 (working directory)，<strong>当进程以相对路径访问文件时则是相对于此目录</strong>。<br>
对于 Python 来说工作目录即执行 <code>python</code> 命令时的目录，可以使用 <code>os.getcwd()</code> 获取。</p> <p>测试目录</p> <div class="language- extra-class"><pre><code>~/path-test/
├── subfolder/
│   └── submodule.py
└── main.py
</code></pre></div><div class="language-python extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#6A737D;">## both main.py and submodule.py</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;working dir&quot;</span><span style="color:#24292E;">, os.getcwd())</span></span>
<span class="line"><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;file path  &quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">__file__</span><span style="color:#24292E;">)</span></span>
<span class="line"></span></code></pre></div><div class="language-shellsession extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#005CC5;font-weight:bold;">~/path-test$</span><span style="color:#24292E;"> python main.py</span></span>
<span class="line"><span style="color:#6A737D;">working dir: /home/yu/path-test</span></span>
<span class="line"><span style="color:#6A737D;">file path:   main.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;font-weight:bold;">~/path-test$</span><span style="color:#24292E;"> python subfolder/submodule.py</span></span>
<span class="line"><span style="color:#6A737D;">working dir: /home/yu/path-test</span></span>
<span class="line"><span style="color:#6A737D;">file path:   subfolder/submodule.py</span></span>
<span class="line"></span></code></pre></div><div class="language-shellsession extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#005CC5;font-weight:bold;">~/path-test$</span><span style="color:#24292E;"> cd subfolder</span></span>
<span class="line"><span style="color:#005CC5;font-weight:bold;">~/path-test/subfolder$</span><span style="color:#24292E;"> python submodule.py</span></span>
<span class="line"><span style="color:#6A737D;">working dir: /home/yu/path-test/subfolder</span></span>
<span class="line"><span style="color:#6A737D;">file path:   submodule.py</span></span>
<span class="line"></span></code></pre></div><p><strong>子进程的工作目录继承自其父进程</strong></p> <p>修改 <code>submodule.py</code> 为</p> <div class="language-python extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> subprocess</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">print</span><span style="color:#24292E;">(subprocess.check_output(</span><span style="color:#032F62;">&quot;tree&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">shell</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span><span style="color:#24292E;">, </span><span style="color:#E36209;">encoding</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;utf-8&quot;</span><span style="color:#24292E;">))</span></span>
<span class="line"></span></code></pre></div><div class="language-shellsession extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#005CC5;font-weight:bold;">~/path-test$</span><span style="color:#24292E;"> python subfolder/submodule.py</span></span>
<span class="line"><span style="color:#6A737D;">.</span></span>
<span class="line"><span style="color:#6A737D;">├── main.py</span></span>
<span class="line"><span style="color:#6A737D;">└── subfolder</span></span>
<span class="line"><span style="color:#6A737D;">    └── submodule.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;font-weight:bold;">~/path-test/subfolder$</span><span style="color:#24292E;"> python submodule.py</span></span>
<span class="line"><span style="color:#6A737D;">.</span></span>
<span class="line"><span style="color:#6A737D;">└── submodule.py</span></span>
<span class="line"></span></code></pre></div><h3 id="模块查找目录-syspath"><a href="#模块查找目录-syspath" class="header-anchor">#</a> 模块查找目录 <code>sys.path</code></h3> <p><code>sys.path</code> 是 Python 尝试导入模块时会去查找的路径列表，默认初始化为 Python 的安装路径下的若干位置，以及 <code>PYTHONPATH</code> 环境变量。在程序中也可以访问修改</p> <p>在运行 Python 时，还会在 <code>sys.path</code> 中额外添加特定路径，对于不同情况：</p> <ol><li><code>python /path/to/script.py</code>：添加 <code>script.py</code> 所在的目录，即 <code>/path/to/</code>，<strong>而不是当前工作目录</strong></li> <li><code>python -m module</code>：添加当前工作目录，即 <code>.</code></li> <li><code>python</code> (REPL) 和 <code>python -c code</code>：添加空字符串，也即当前工作目录</li></ol> <p>在情况 1 下如果运行的是某个子目录下的 Python 脚本就很容易出现 <code>ModuleNotFoundError</code>，因为当前工作目录并不在 <code>sys.path</code> 里</p> <p><a href="https://docs.python.org/3/library/sys.html#sys.path" target="_blank" rel="noopener noreferrer">https://docs.python.org/3/library/sys.html#sys.path<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>TODO</p> <p>absolute and relative imports</p> <p>https://stackoverflow.com/a/43859946/8682688<br>
https://docs.python.org/3/tutorial/modules.html#the-module-search-path<br>
https://www.pythonforthelab.com/blog/complete-guide-to-imports-in-python-absolute-relative-and-more/</p> <h2 id="手动断行"><a href="#手动断行" class="header-anchor">#</a> 手动断行</h2> <p>句末的反斜杠 <code>\</code> 会把多个物理行拼接为一个逻辑行（在 <code>&quot;&quot;&quot;</code>/<code>'''</code> 多行字符串和注释中除外）</p> <div class="language-python extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#24292E;">is_valid_date </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1900</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> year </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2100</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> month </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">12</span><span style="color:#24292E;"> \</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> day </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">31</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">a_str </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;this is a long</span><span style="color:#005CC5;">\</span></span>
<span class="line"><span style="color:#032F62;">         string&quot;</span></span>
<span class="line"><span style="color:#6A737D;">## 'this is a long         string'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">b_str </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;this is a long &quot;</span><span style="color:#24292E;">\</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;string&quot;</span></span>
<span class="line"><span style="color:#6A737D;">## 'this is a long string'</span></span>
<span class="line"></span></code></pre></div><p><a href="https://docs.python.org/3/reference/lexical_analysis.html#explicit-line-joining" target="_blank" rel="noopener noreferrer">Lexical analysis — Python documentation &gt; Explicit line joining<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="格式化字符串-string-format"><a href="#格式化字符串-string-format" class="header-anchor">#</a> 格式化字符串 (string format)</h2> <div class="language-python extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#6A737D;">## Basics             ## use &quot;·&quot; to visualize whitespace</span></span>
<span class="line"><span style="color:#032F62;">&quot;{} {}&quot;</span><span style="color:#24292E;">.format(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)  </span><span style="color:#6A737D;">## &quot;1·2&quot;</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{1}</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">{2}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">            </span><span style="color:#6A737D;">## &quot;1·2&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## Each field can also specify an optional set of &quot;format specifiers&quot;,</span></span>
<span class="line"><span style="color:#6A737D;">## which goes after the colon &quot;:&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## The default syntax</span></span>
<span class="line"><span style="color:#6A737D;">## [[fill]align][sign][#][0][min_width][.precision][type]</span></span>
<span class="line"><span style="color:#6A737D;">##        │                                         └ e.g., b e f %</span></span>
<span class="line"><span style="color:#6A737D;">##        └ e.g., &lt; &gt; ^</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## Padding and alignment</span></span>
<span class="line"><span style="color:#24292E;">a </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;test&quot;</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">a</span><span style="color:#D73A49;">:10</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">             </span><span style="color:#6A737D;">## &quot;test······&quot; (width 10)</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">a</span><span style="color:#D73A49;">:&lt;10</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">            </span><span style="color:#6A737D;">## &quot;test······&quot;</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">a</span><span style="color:#D73A49;">:&gt;10</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">            </span><span style="color:#6A737D;">## &quot;······test&quot;</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">a</span><span style="color:#D73A49;">:^10</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">            </span><span style="color:#6A737D;">## &quot;···test···&quot;</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">a</span><span style="color:#D73A49;">:_&lt;10</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">           </span><span style="color:#6A737D;">## &quot;test______&quot; (fill &quot;_&quot;)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## Floats</span></span>
<span class="line"><span style="color:#24292E;">b </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">b</span><span style="color:#D73A49;">:5</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">              </span><span style="color:#6A737D;">## &quot;··0.5&quot; (`float` and `int` are right aligned by default)</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">b</span><span style="color:#D73A49;">:&lt;5</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">             </span><span style="color:#6A737D;">## &quot;0.5··&quot;</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">b</span><span style="color:#D73A49;">:05</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">             </span><span style="color:#6A737D;">## &quot;000.5&quot; (zero-padding)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">b</span><span style="color:#D73A49;">:.3f</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">            </span><span style="color:#6A737D;">## &quot;0.500&quot;</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{0.6666</span><span style="color:#D73A49;">:.3f</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">       </span><span style="color:#6A737D;">## &quot;0.667&quot; (rounded)</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">b</span><span style="color:#D73A49;">:.3e</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">            </span><span style="color:#6A737D;">## &quot;5.000e-01&quot;</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">b</span><span style="color:#D73A49;">:.2%</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">            </span><span style="color:#6A737D;">## &quot;50.00%&quot;</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">b</span><span style="color:#D73A49;">:6.2f</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">           </span><span style="color:#6A737D;">## &quot;··0.50&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## Explicit type conversion</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">a</span><span style="color:#D73A49;">!s</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">              </span><span style="color:#6A737D;">## equals f&quot;{str(a)}&quot;</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">a</span><span style="color:#D73A49;">!r:10</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">           </span><span style="color:#6A737D;">## equals f&quot;{repr(a):10}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">b</span><span style="color:#D73A49;">:5</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">              </span><span style="color:#6A737D;">## &quot;··0.5&quot;</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">b</span><span style="color:#D73A49;">!s:5</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">            </span><span style="color:#6A737D;">## &quot;0.5··&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## The `datetime` class provides its own format specification</span></span>
<span class="line"><span style="color:#24292E;">c </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> datetime.now()</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">c:</span><span style="color:#D73A49;">%</span><span style="color:#24292E;">Y</span><span style="color:#D73A49;">-%</span><span style="color:#24292E;">m</span><span style="color:#D73A49;">-%</span><span style="color:#24292E;">d</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">       </span><span style="color:#6A737D;">## &quot;2022-02-17&quot; (just like in the `strftime()` function)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## Self-documenting expressions with `=` (New in Python 3.8)</span></span>
<span class="line"><span style="color:#24292E;">theta </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">30</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">theta</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">, </span><span style="color:#005CC5;">{</span><span style="color:#24292E;">cos(radians(theta))</span><span style="color:#D73A49;">=:.3f</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">## &quot;theta=30, cos(radians(theta))=0.866&quot;</span></span>
<span class="line"></span></code></pre></div><p>Format specifiers may also contain evaluated expressions.</p> <div class="language-python extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#24292E;">width     </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">8</span></span>
<span class="line"><span style="color:#24292E;">precision </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span></span>
<span class="line"><span style="color:#24292E;">value     </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">12.3456</span></span>
<span class="line"><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">value</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">width</span><span style="color:#005CC5;">}</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">precision</span><span style="color:#005CC5;">}</span><span style="color:#D73A49;">f</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#6A737D;">## &quot;···12.35&quot;</span></span>
<span class="line"></span></code></pre></div><div class="language-python extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#032F62;">&quot;{first} {last}&quot;</span><span style="color:#24292E;">.format(</span><span style="color:#E36209;">first</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;Hello&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">last</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;world!&quot;</span><span style="color:#24292E;">)  </span><span style="color:#6A737D;">## &quot;Hello world!&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">data </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span><span style="color:#032F62;">&quot;first&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Hello&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;last&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;world!&quot;</span><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#032F62;">&quot;{first} {last}&quot;</span><span style="color:#24292E;">.format(</span><span style="color:#D73A49;">**</span><span style="color:#24292E;">data)                        </span><span style="color:#6A737D;">## &quot;Hello world!&quot;</span></span>
<span class="line"></span></code></pre></div><p><a href="https://pyformat.info/" target="_blank" rel="noopener noreferrer">PyFormat (intuitive examples)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://strftime.org/" target="_blank" rel="noopener noreferrer">Python strftime reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://www.python.org/dev/peps/pep-3101/#format-specifiers" target="_blank" rel="noopener noreferrer">PEP 3101 -- Standard Format Specifiers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://docs.python.org/3/whatsnew/3.8.html#f-strings-support-for-self-documenting-expressions-and-debugging" target="_blank" rel="noopener noreferrer">What's New in Python 3.8<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="正则表达式"><a href="#正则表达式" class="header-anchor">#</a> 正则表达式</h2> <p>正则表达式本身就不多介绍了，见 <a href="https://regex101.com/" target="_blank" rel="noopener noreferrer">regex 101<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>首先值得一提的就是 Python <mark>raw string</mark>，其中的反斜杠 <code>\</code> 不表示转义字符，而是 literal <code>\</code></p> <div class="language-python extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\</span><span style="color:#032F62;">d&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">r</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\d</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># True</span></span>
<span class="line"></span></code></pre></div><h3 id="字符串替换resub"><a href="#字符串替换resub" class="header-anchor">#</a> 字符串替换<span lang="zh-CN" class="cn-font">——</span><code>re.sub</code></h3> <p>大部分时候我们仅仅只是想做个（正则）字符串替换<br> <code>re.sub(pattern, repl, string, count=0, flags=0)</code></p> <ul><li><code>pattern</code> 要被换掉的模式</li> <li><code>repl</code> 要换成的模式，可以是字符串（支持 backreference 如 <code>\2</code>）或者函数</li> <li><code>string</code> 要进行替换的字符串</li></ul> <p>（<code>count</code> 若非 0 则表示最大替换次数，<code>flags</code> 对应正则表达式的 flags）</p> <div class="language-python extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#24292E;">re.sub(</span><span style="color:#D73A49;">r</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">(.</span><span style="color:#D73A49;">*</span><span style="color:#005CC5;">)</span><span style="color:#032F62;"> &gt; </span><span style="color:#005CC5;">(.</span><span style="color:#D73A49;">*</span><span style="color:#005CC5;">)</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">r</span><span style="color:#032F62;">&quot;</span><span style="color:#22863A;">\2</span><span style="color:#032F62;"> &lt; </span><span style="color:#22863A;">\1</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;a &gt; b&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6A737D;"># 'b &lt; a'</span></span>
<span class="line"></span></code></pre></div><h3 id="字符串匹配和提取"><a href="#字符串匹配和提取" class="header-anchor">#</a> 字符串匹配和提取</h3> <p><code>re.match</code> 和 <code>re.search</code>，都接受参数 <code>(pattern, string, flags=0)</code>，返回 <code>None</code> 或者 match 对象</p> <div class="language-python extra-class"><pre tabindex="0" class="shiki github-light" style="background-color:#fff;"><code><span class="line"><span style="color:#24292E;">m </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> re.match(</span><span style="color:#D73A49;">r</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">(\w</span><span style="color:#D73A49;">+</span><span style="color:#005CC5;">)</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">(\w</span><span style="color:#D73A49;">+</span><span style="color:#005CC5;">)</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;Isaac Newton, physicist&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">m.group(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">)     </span><span style="color:#6A737D;"># 'Isaac Newton'       The entire match</span></span>
<span class="line"><span style="color:#24292E;">m.group(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)     </span><span style="color:#6A737D;"># 'Isaac'              The first parenthesized subgroup.</span></span>
<span class="line"><span style="color:#24292E;">m.group(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)     </span><span style="color:#6A737D;"># 'Newton'             The second parenthesized subgroup.</span></span>
<span class="line"><span style="color:#24292E;">m.group(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)  </span><span style="color:#6A737D;"># ('Isaac', 'Newton')  Multiple arguments give us a tuple.</span></span>
<span class="line"><span style="color:#24292E;">m.groups()     </span><span style="color:#6A737D;"># ('Isaac', 'Newton')  All subgroups in a tuple.</span></span>
<span class="line"></span></code></pre></div><p><code>re.match</code> 要求 <code>pattern</code> 出现在字符串 <code>string</code> 的开头，<code>re.search</code> 则允许其出现在字符串的任意位置</p> <p>如果需要多次使用某个正则表达式，可以用 <code>re.compile()</code> 来生成一个 pattern 对象，其同样可以使用上面这些函数 <code>sub/match/search</code>，甚至更精细的功能。</p> <h3 id="其它字符串分割"><a href="#其它字符串分割" class="header-anchor">#</a> 其它：字符串分割</h3> <p><code>re.split(pattern, string, maxsplit=0, flags=0)</code></p> <p><a href="https://docs.python.org/3/library/re.html" target="_blank" rel="noopener noreferrer">Regular expression operations - Python documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last updated:</span> <span class="time">4/17/2023, 12:31:33 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/notes/programming/python/matplotlib.html" class="prev">
        Matplotlib
      </a></span> <span class="next"><a href="/notes/programming/python/logging.html">
        Logging
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/notes/assets/js/app.943eb73b.js" defer></script><script src="/notes/assets/js/3.8465ba19.js" defer></script><script src="/notes/assets/js/82.ebcf132b.js" defer></script>
  </body>
</html>
